<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="shortcut icon" href="logo.png" type="image/x-icon">
		<style>
			#printFrame {
				display: none;
				/* éšè—iframe */
				width: 0;
				/* åˆå§‹å®½åº¦è®¾ç½®ä¸º0ï¼Œä»¥é¿å…é¡µé¢å¸ƒå±€å˜åŒ– */
				height: 0;
				/* åˆå§‹é«˜åº¦è®¾ç½®ä¸º0 */
			}

			#alltable {
				display: none;
			}

			/* æ‰“å°æ ·å¼ */
			@media print {
				body * {
					visibility: hidden;
					/* éšè—é¡µé¢ä¸Šæ‰€æœ‰å†…å®¹ */
				}

				#printArea,
				#printArea * {
					visibility: visible;
					/* ä»…æ˜¾ç¤ºè¦æ‰“å°çš„divåŠå…¶å†…å®¹ */
					position: static;
					/* é‡ç½®ä½ç½®å±æ€§ï¼Œé¿å…æ‰“å°é—®é¢˜ */
					page-break-after: auto;
					/* æ§åˆ¶åˆ†é¡µ */
				}

				@page {
					margin: 0mm;
					/* è®¾ç½®é¡µè¾¹è·ä¸º0 */
					size: auto;
					/* è‡ªåŠ¨é€‚åº”å†…å®¹å¤§å° */
				}
			}
		</style>
		<title>æ’æœŸ</title>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
		<script>
			//å€’è®¡æ—¶è½¯ä»¶ç”¨
			function calculateSecondsDifference(date1String, date2String) {
				const date1 = new Date(date1String);
				const date2 = new Date(date2String);
				const diffInMilliseconds = Math.abs(date1 - date2);
				const diffInSeconds = Math.ceil(diffInMilliseconds / 1000);
				return diffInSeconds;
			}
			const date1 = "";
			const date2 = "1950-01-01T00:00:00";
			//const secondsDifference = calculateSecondsDifference(date1, date2);
			//è§£æ
			let movies = []; //Excelè¡¨ä¸­è·å–çš„jsonæ ¼å¼çš„å½±ç‰‡ä¿¡æ¯
			function getMovies_timejson(movies_timejson) { //è·å–é¢„è®¾çš„jsonæ ¼å¼å½±ç‰‡ä¿¡æ¯
				movies = movies_timejson;
				//console.log(movies);
			}
			var indicesToDelete = []; //é»˜è®¤éœ€è¦åˆ é™¤çš„åœºæ¬¡ä¸ºç©º
			function extractField() {
				document.getElementById('alltable').style.display = 'block';
				yincang(); //éšè—ä¿æ´æ—©æ™šç­div
				//console.log("æå–")
				//æ¸…é™¤è¡¨æ ¼è®°å½•
				let NeedCheck = []; //éœ€è¦ç²¾ç¡®æ—¶é—´çš„ç”µå½±å
				//console.log(movies);
				document.getElementById('tableContainer').innerHTML = '';
				// è·å–è¾“å…¥æ¡†ä¸­çš„JSONå­—ç¬¦ä¸²
				var jsonInput = document.getElementById('json-input').value;
				document.getElementById('start').value = jsonInput;
				// å°è¯•è§£æJSONå­—ç¬¦ä¸²
				try {
					var jsonData = JSON.parse(jsonInput);
					//console.log(jsonData.data.arr_date_plan);//å…¨éƒ¨åœºæ¬¡
					//åˆ é™¤è™šæ‹Ÿåœºæ¬¡
					//let indicesToDelete = [4,3,2,1,0];//è™šæ‹Ÿåœºæ¬¡çš„åºå·
					//console.log('åˆ é™¤äº† ' + indicesToDelete + 'åœº');
					// ä»åå¾€å‰åˆ é™¤å…ƒç´ 
					indicesToDelete.sort((a, b) => b - a).forEach(index => {
						jsonData.data.arr_date_plan.splice(index, 1);
					});
					indicesToDelete = []; //åˆ é™¤åæ¸…ç©ºåˆ é™¤è®°å½•ï¼Œé˜²æ­¢å¤šåˆ 
					//console.log(JSON.stringify(jsonData.data.arr_date_plan, null, 2));
					//console.log(jsonData.data.arr_date_plan)//å»é™¤åçš„åœºæ¬¡
					document.getElementById('json-input').value = '{"data":{"arr_date_plan":' + JSON.stringify(jsonData.data
						.arr_date_plan, null, 0) + '}}';
					//console.log(document.getElementById('json-input').value);
					//console.log(JSON.stringify(jsonData.data.arr_date_plan, null, 0))
					var table = document.createElement('table');
					table.style.borderCollapse = 'collapse';
					table.style.fontSize = 'smaller';
					table.id = 'tableContainer_div';
					//table.style.width = '100%';

					// åˆ›å»ºè¡¨å¤´
					var thead = document.createElement('thead');
					var headerRow = document.createElement('tr');
					['å¼€å§‹', 'ç»“æŸ', 'ç”µå½±', 'å½±å…', 'X'].forEach(function(text) {
						var th = document.createElement('th');
						th.textContent = text;
						th.style.border = '1px solid black';
						th.style.padding = '2px';
						headerRow.appendChild(th);
					});
					thead.appendChild(headerRow);
					table.appendChild(thead);

					// åˆ›å»ºè¡¨æ ¼ä½“
					var tbody = document.createElement('tbody');
					var Plan_yes = 0; //å®¡æ ¸é€šè¿‡(é‡Šæ”¾)
					var Plan_no = 0; //æœªå®¡æ ¸(æš‚åœ)
					var sale_status_sale = 0; //æ­£å¸¸å”®å–
					var sale_status_stop = 0; //æš‚åœåœºæ¬¡
					for (var i = 0; i < jsonData.data.arr_date_plan.length; i++) {
						var rowData = jsonData.data.arr_date_plan[i];
						//console.log(jsonData.data.arr_date_plan[i].approve_status);
						if (jsonData.data.arr_date_plan[i].approve_status == 'APPROVED') {
							Plan_yes++; //ç»Ÿè®¡é‡Šæ”¾åœºæ¬¡æ•°é‡
						} else {
							Plan_no++; //ç»Ÿè®¡æœªé‡Šæ”¾åœºæ¬¡æ•°é‡
						}
						if (jsonData.data.arr_date_plan[i].sale_status == 'SALE') {
							sale_status_sale++;
						} else {
							sale_status_stop++;
						}
						//console.log(rowData)
						var row = document.createElement('tr');

						var starttimeCell = document.createElement('td');
						var starttime = rowData.show_time_start;
						starttimeCell.textContent = starttime;
						starttimeCell.style.border = '1px solid black';
						starttimeCell.style.padding = '4px';
						starttimeCell.style.textAlign = 'center';
						row.appendChild(starttimeCell);

						var endtimeCell = document.createElement('td');
						var endtime = rowData.show_time_end;
						endtimeCell.textContent = endtime;
						endtimeCell.style.border = '1px solid black';
						endtimeCell.style.padding = '4px';
						endtimeCell.style.textAlign = 'center';
						row.appendChild(endtimeCell);


						var nameCell = document.createElement('td');
						//result0:æ™®é€šç«‹ä½“=æ™®é€š
						const th0 = 'æ™®é€šç«‹ä½“'
						const tihuan0 = 'æ™®é€š';
						const result0 = replaceSpecifiedString(rowData.display_name, th0, tihuan0)
						//result1:å»æ‰ï¼ˆæ™®é€š/å›½è¯­ï¼‰
						const th1 = 'ï¼ˆæ™®é€š/å›½è¯­ï¼‰'
						const tihuan1 = '';
						const result1 = replaceSpecifiedString(result0, th1, tihuan1)
						//result2:ï¼ˆæ™®é€š/æ—¥è¯­ï¼‰=(æ—¥è¯­)
						const th2 = 'ï¼ˆæ™®é€š/æ—¥è¯­ï¼‰'
						const tihuan2 = 'ï¼ˆæ—¥è¯­ï¼‰ğŸŒ';
						const result2 = replaceSpecifiedString(result1, th2, tihuan2)
						//result3:ï¼ˆæ™®é€š/è‹±è¯­ï¼‰=(è‹±è¯­)
						const th3 = 'ï¼ˆæ™®é€š/è‹±è¯­ï¼‰'
						const tihuan3 = 'ï¼ˆè‹±è¯­ï¼‰ğŸŒ';
						const result3 = replaceSpecifiedString(result2, th3, tihuan3)
						//result4:ï¼ˆæ™®é€š/å°åº¦è¯­ï¼‰=(å°åº¦è¯­)
						const th4 = 'ï¼ˆæ™®é€š/å°åº¦è¯­ï¼‰'
						const tihuan4 = 'ï¼ˆå°åº¦è¯­ï¼‰ğŸŒ';
						const result4 = replaceSpecifiedString(result3, th4, tihuan4)
						//result5:ï¼ˆæ™®é€š/å°å°¼è¯­ï¼‰=(å°å°¼è¯­)
						const th5 = 'ï¼ˆæ™®é€š/å°å°¼è¯­ï¼‰'
						const tihuan5 = 'ï¼ˆå°å°¼è¯­ï¼‰ğŸŒ';
						const result5 = replaceSpecifiedString(result4, th5, tihuan5)
						//result6:ï¼ˆæ™®é€š/æ³•è¯­ï¼‰=(æ³•è¯­)
						const th6 = 'ï¼ˆæ™®é€š/æ³•è¯­ï¼‰'
						const tihuan6 = 'ï¼ˆæ³•è¯­ï¼‰ğŸŒ';
						const result6 = replaceSpecifiedString(result5, th6, tihuan6)
						//result7:ï¼ˆæ™®é€š/æ„å¤§åˆ©è¯­ï¼‰=(æ„å¤§åˆ©è¯­)
						const th7 = 'ï¼ˆæ™®é€š/æ„å¤§åˆ©è¯­ï¼‰'
						const tihuan7 = 'ï¼ˆæ„å¤§åˆ©è¯­ï¼‰ğŸŒ';
						const result7 = replaceSpecifiedString(result6, th7, tihuan7)
						//result8:ï¼ˆæ™®é€š/éŸ©è¯­ï¼‰=(éŸ©è¯­)
						const th8 = 'ï¼ˆæ™®é€š/éŸ©è¯­ï¼‰'
						const tihuan8 = 'ï¼ˆéŸ©è¯­ï¼‰ğŸŒ';
						const result8 = replaceSpecifiedString(result7, th8, tihuan8)
						//result9:ï¼ˆæ™®é€š/ä¿„è¯­ï¼‰=(ä¿„è¯­)
						const th9 = 'ï¼ˆæ™®é€š/ä¿„è¯­ï¼‰'
						const tihuan9 = 'ï¼ˆä¿„è¯­ï¼‰ğŸŒ';
						const result9 = replaceSpecifiedString(result8, th9, tihuan9)
						//result10:ï¼ˆæ™®é€š/å…¶ä»–ï¼‰=(å…¶ä»–)
						const th10 = 'ï¼ˆæ™®é€š/å…¶ä»–ï¼‰'
						const tihuan10 = 'ï¼ˆå…¶ä»–ï¼‰ğŸŒ';
						const result10 = replaceSpecifiedString(result9, th10, tihuan10)
						//result11:ï¼ˆæ•°å­—3Dï¼‰=(3D)
						const th11 = 'ï¼ˆæ•°å­—3Dï¼‰'
						const tihuan11 = ' 3DğŸ‘“';
						const result11 = replaceSpecifiedString(result10, th11, tihuan11)
						//result11:ï¼ˆæ•°å­—3Dï¼‰=(3D)
						const th12 = 'ï¼ˆæ•°å­—ï¼‰'
						const tihuan12 = '';
						const result12 = replaceSpecifiedString(result11, th12, tihuan12)
						const result = result12;
						nameCell.textContent = result;
						nameCell.style.border = '1px solid black';
						nameCell.style.padding = '4px';
						nameCell.style.textAlign = 'left';
						row.appendChild(nameCell);

						var hallNameCell = document.createElement('td');
						hallNameCell.textContent = rowData.hall_name.slice(0, 1);
						hallNameCell.style.border = '1px solid black';
						hallNameCell.style.padding = '4px';
						hallNameCell.style.textAlign = 'center';
						row.appendChild(hallNameCell);

						var deleteMovie = document.createElement('td');
						const checkbox = document.createElement('input');
						checkbox.type = 'checkbox';
						checkbox.value = i; // è®¾ç½®å€¼ä¸ºè¡Œå·ï¼ˆä»0å¼€å§‹ï¼‰
						deleteMovie.appendChild(checkbox);
						row.appendChild(deleteMovie);

						tbody.appendChild(row);
					}


					table.appendChild(tbody);
					//console.log('é‡Šæ”¾åœºæ¬¡:'+Plan_yes);
					//console.log('æœªé‡Šæ”¾åœºæ¬¡:'+Plan_no);
					// å°†è¡¨æ ¼æ·»åŠ åˆ°ç½‘é¡µä¸­çš„æŒ‡å®šä½ç½®
					document.getElementById('tableContainer').appendChild(table);
					//console.log("å½“å‰æ—¥æœŸç”µå½±æ•°é‡ä¸º:" + jsonData.data.arr_date_plan.length);
					var all = "";
					var wucha_all = "";
					var wucha_start = "";
					var wucha_end = "";
					let wucha_1h_tishi = []; //å¼€ç¯æ—¶é—´æœªç²¾ç¡®ï¼Œ1å°æ—¶åä¸€ç›´å¼¹å‡ºæç¤ºè¦æ›´æ–°
					let moviesData = [];
					//å®šä¹‰æ’­éŸ³å¤§å¸ˆæ•°ç»„
					let TaskID = [],
						TaskTopic = [],
						TaskContent = [],
						BegDate = [],
						BegTime = [],
						EndDate = [],
						EndTime = [];
					var Interval = 6;
					WeekFlag1 = 1, WeekFlag2 = 1, WeekFlag3 = 1, WeekFlag4 = 1, WeekFlag5 = 1, WeekFlag6 = 1, WeekFlag7 = 1,
						DingFlag = 1, VSID = 3, BMID = 0, BCTimes = 0, BCFlag = 0, Timeout = 0, TaskLevel = 1, StopFlag = 0;
					var BYDS_BuBian_all = "\t" + Interval + "\t" + WeekFlag1 + "\t" + WeekFlag2 + "\t" + WeekFlag3 + "\t" +
						WeekFlag4 + "\t" + WeekFlag5 + "\t" + WeekFlag6 + "\t" + WeekFlag7 + "\t" + DingFlag + "\t" + VSID +
						"\t" + BMID + "\t" + BCTimes + "\t" + BCFlag + "\t" + Timeout + "\t" + TaskLevel + "\t" + StopFlag;
					var BYDS_all = "";
					var Suijishu = Math.floor(Math.random() * 10000) + 1;
					for (var i = 0; i < jsonData.data.arr_date_plan.length; i++) {
						var name = jsonData.data.arr_date_plan[i].display_name; //ç”µå½±å+è¯­è¨€+3D
						var name_min = jsonData.data.arr_date_plan[i].movie_name; //ç”µå½±å

						//æ›¿æ¢æ‰ç”µå½±åä¸­å¯èƒ½å‡ºé—®é¢˜çš„å­—ç¬¦
						name_min = replaceSpecifiedString(name_min, 'ï¼ˆæ•°å­—ï¼‰', '');
						name_min = replaceSpecifiedString(name_min, 'ï¼ˆèˆå°çºªå½•ç”µå½±ï¼‰', '');

						var date = jsonData.data.arr_date_plan[i].plan_date; //2023-01-01
						var time = jsonData.data.arr_date_plan[i].show_time_start; //2023-01-01T00:00:00
						var time_end = jsonData.data.arr_date_plan[i].show_time_end; //2023-01-01T00:00:00
						var time_min = time.slice(11, 16); //00:00
						var dis_version = jsonData.data.arr_date_plan[i].dis_version; //æ™®é€š?æ™®é€šç«‹ä½“?
						var hall_name = jsonData.data.arr_date_plan[i].hall_name;
						var djs_tishi_light_on = "";
						var djs_tishi_dongzuo = "";
						//è®¡ç®—æ’­éŸ³å¤§å¸ˆæé†’æ—¶é—´ï¼Œåº”è¯¥æ¯”ç”µå½±å¼€å§‹æ—¶é—´æå‰10åˆ†é’Ÿæé†’ï¼Œ6åˆ†é’Ÿåå†æ¬¡æé†’
						//let BYtime = "2023-01-01T00:01:00";  

						// å°†æ—¶é—´å­—ç¬¦ä¸²è½¬æ¢ä¸ºDateå¯¹è±¡  
						let BYdate = new Date(time);

						// ä»å½“å‰åˆ†é’Ÿæ•°ä¸­å‡å»10åˆ†é’Ÿ  
						BYdate.setMinutes(BYdate.getMinutes() - 10);

						// è·å–æ ¼å¼åŒ–åçš„æ—¶é—´éƒ¨åˆ†  
						let BYyear = BYdate.getFullYear();
						let BYmonth = (BYdate.getMonth() + 1).toString().padStart(2, '0'); // æœˆä»½ä»0å¼€å§‹ï¼ŒåŠ 1åæ ¼å¼åŒ–  
						let BYday = BYdate.getDate().toString().padStart(2, '0');
						let BYhours = BYdate.getHours().toString().padStart(2, '0');
						let BYminutes = BYdate.getMinutes().toString().padStart(2, '0');
						let BYseconds = BYdate.getSeconds().toString().padStart(2, '0');

						// æ‹¼æ¥æˆç›®æ ‡æ ¼å¼çš„å­—ç¬¦ä¸²  
						let newBYTime = `${BYyear}-${BYmonth}-${BYday}T${BYhours}:${BYminutes}:${BYseconds}`;

						//console.log(newBYTime); // è¾“å‡ºç±»ä¼¼ "2023-01-01T00:51:00"ï¼Œè¿™å–å†³äºæœ¬åœ°æ—¶åŒº

						//å»æ‰æ’­éŸ³é‡Œçš„ï¼ˆæ•°å­—3Dï¼‰
						name_min = replaceSpecifiedString(name_min, "ï¼ˆæ•°å­—3Dï¼‰", "")
						//æ ‡è®°3Dç”µå½±
						if (dis_version == "æ™®é€š") {
							dis_version = replaceSpecifiedString(dis_version, "æ™®é€š", "")
							//console.log(dis_version);
						} else if (dis_version == "æ™®é€šç«‹ä½“") {
							dis_version = replaceSpecifiedString(dis_version, "æ™®é€šç«‹ä½“", "3D")
							//console.log(dis_version);
						}
						//å¢åŠ å€’è®¡æ—¶çš„1å…åŠ¨ä½œæç¤º
						if (hall_name.slice(0, 1) == "1") {
							djs_tishi_dongzuo = "||å¼€å§‹||â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆæ¢åŠ¨ä½œâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ";
						} else {
							djs_tishi_dongzuo = "||å¼€å§‹"
						}
						//djs_tishi_dongzuo = replaceSpecifiedString(hall_name.slice(0,1),"1","å¼€å§‹ã€æ¢åŠ¨ä½œã€‘");
						//æ›¿æ¢æ’­éŸ³å¤§å¸ˆå¤šéŸ³å­—ï¼Œè®¡ç®—å®é™…äº®ç¯æ—¶é—´
						const secondsDifference_start = calculateSecondsDifference(time, date2);
						var secondsDifference_end = calculateSecondsDifference(time_end, date2);
						var secondsDifference_end_current = '';
						const result = processMovieString(name_min);
						//console.log(result);
						if (result == null) { //å¼€ç¯æ—¶é—´è¡¨ä¸€ç‚¹ä¿¡æ¯æ²¡æœ‰
							name_min_new = name_min; //æ’­éŸ³å¤§å¸ˆæ— å¤šéŸ³å­—éœ€è¦ä¿®æ”¹
							secondsDifference_end_current = secondsDifference_end;
							djs_tishi_light_on = "ç»“æŸ||è¯·æ›´æ–°å‡†ç¡®æ—¶é—´"
							NeedCheck.push(name_min); //å°†éœ€è¦ç²¾ç¡®æ—¶é—´çš„ç”µå½±åç»™å¯¹åº”æ•°ç»„ï¼Œæ–¹ä¾¿è¾“å‡ºæç¤º
							//console.log(name_min_new + "  æ— ä»»ä½•ä¿¡æ¯");
						} else {
							if (result.nickname == undefined) { //å¦‚æœæ˜µç§°ä¸ºç©ºï¼Œåˆ™ä¸éœ€è¦æ›¿æ¢
								name_min_new = name_min;
							} else {
								name_min_new = result.nickname;
							}
							if (result.lightOnTime == undefined || result.posterTime == undefined || result.lightOnTime == '' ||
								result.posterTime == '') { //å¦‚æœä¸¤ä¸ªæ—¶é—´ä¸å…¨
								secondsDifference_end_current = secondsDifference_end;
								djs_tishi_light_on = "ç»“æŸ||è¯·æ›´æ–°å‡†ç¡®æ—¶é—´";
								NeedCheck.push(name_min);
							} else { //å¦‚æœä¿¡æ¯å…¨éƒ¨å­˜åœ¨
								secondsDifference_end_current = parseInt(secondsDifference_start) + parseInt(result
									.timeDifference) - 60;
								djs_tishi_light_on = "||â‘ åˆ†åäº®ç¯";
							}
						}
						/*if (result == null || result.lightOnTime == undefined || result.posterTime == undefined) {
							name_min_new = name_min; //æ’­éŸ³å¤§å¸ˆæ— å¤šéŸ³å­—éœ€è¦ä¿®æ”¹
							secondsDifference_end_current = secondsDifference_end;
							djs_tishi_light_on = "ç»“æŸ||è¯·æ›´æ–°å‡†ç¡®æ—¶é—´"
							NeedCheck.push(name_min);
							console.log(name_min_new + "  1");
						} else {
							if (result.nickname == undefined) {
								name_min_new = name_min; //æ’­éŸ³å¤§å¸ˆæ— å¤šéŸ³å­—éœ€è¦ä¿®æ”¹
								secondsDifference_end_current = parseInt(secondsDifference_start) + parseInt(result
									.timeDifference) - 60;
								djs_tishi_light_on = "||â‘ åˆ†åäº®ç¯";
								console.log(name_min_new + "  2");
							} else {
								name_min_new = result.nickname; //æ›¿æ¢å¤šéŸ³å­—
								secondsDifference_end_current = parseInt(secondsDifference_start) + parseInt(result
									.timeDifference) - 60;
								djs_tishi_light_on = "||â‘ åˆ†åäº®ç¯";
								console.log(name_min_new + "  3");
								//console.log(secondsDifference_end_current)
							}
						}*/
						//æ’­éŸ³å¤§å¸ˆæ•°ç»„ä¾æ¬¡èµ‹å€¼
						TaskID[i] = Suijishu + i;
						TaskTopic[i] = name_min;
						//TaskContent[i] = "\=\"æ¬¢è¿å…‰ä¸´äºšæ˜Ÿå°é¾™æ¿€å…‰å½±åŸ \"&CHAR(10)&\"" + hall_name.slice(0,1) + "å·å…" + time_min + "çš„" + dis_version + "ç”µå½±ã€Š" + name_min +"ã€‹ç°åœ¨å¼€å§‹æ£€ç¥¨è¿›åœº \"&CHAR(10)&\"" + hall_name.slice(0,1) + "å·å…" + time_min + "çš„ç”µå½±ã€Š" + name_min +"ã€‹ç°åœ¨å¼€å§‹æ£€ç¥¨è¿›åœº \"&CHAR(10)&\"æœ¬å½±åŸç¦æ­¢å¸çƒŸï¼Œè°¢ç»å¤–å¸¦é£Ÿå“ï¼Œè°¢è°¢æ‚¨çš„é…åˆï¼Œç¥æ‚¨è§‚å½±æ„‰å¿«\"";
						TaskContent[i] = "æ¬¢è¿å…‰ä¸´äºšæ˜Ÿå°é¾™æ¿€å…‰å½±åŸ " + hall_name.slice(0, 1) + "å·å…" + time_min + "çš„" + dis_version + "ç”µå½± ã€Š" +
							name_min_new + "ã€‹ ç°åœ¨å¼€å§‹æ£€ç¥¨è¿›åœº " + hall_name.slice(0, 1) + "å·å…" + time_min + "çš„" + dis_version + "ç”µå½± ã€Š" +
							name_min_new + "ã€‹ ç°åœ¨å¼€å§‹æ£€ç¥¨è¿›åœº æœ¬å½±åŸç¦æ­¢å¸çƒŸï¼Œè°¢ç»å¤–å¸¦é£Ÿå“ï¼Œè°¢è°¢æ‚¨çš„é…åˆï¼Œç¥æ‚¨è§‚å½±æ„‰å¿«";
						BegDate[i] = time.slice(0, 10);
						BegTime[i] = newBYTime.slice(0, 10) + " " + newBYTime.slice(11, 21);;
						EndDate[i] = time_end.slice(0, 10);
						EndTime[i] = time.slice(0, 10) + " " + time.slice(11, 21);
						BYDS_all = BYDS_all + TaskID[i] + "\t" + TaskTopic[i] + "\t" + TaskContent[i] + "\t" + BegDate[i] +
							"\t" + BegTime[i] + "\t" + EndDate[i] + "\t" + EndTime[i] + BYDS_BuBian_all + "\n";
						document.getElementById('byds').innerHTML = BYDS_all;
						//console.log(BYDS_all);
						//å¤§å±å¹•çš„æ•°ç»„
						let onebyone = {
							display_name: name_min, // å‡è®¾ç”µå½±åæ˜¯Movie 1, Movie 2, ...
							show_time_start: time // å‡è®¾å¼€åœºæ—¶é—´æ˜¯æ¯éš”ä¸¤å°æ—¶ä¸€åœºï¼Œä»10:00å¼€å§‹
						}
						moviesData.push(onebyone);

						all = all + jsonData.data.arr_date_plan[i].hall_name + "  " + jsonData.data.arr_date_plan[i]
							.show_time_start.slice(11, 16) + "  " + jsonData.data.arr_date_plan[i].display_name + "\n"; //å‰å°ç¥¨

						wucha_start = wucha_start + secondsDifference_start + "-1    10110054 010    " + hall_name.slice(0, 1) +
							name_min.slice(0, 3) + dis_version + djs_tishi_dongzuo +
							"                                                                                                                                                                                                                                                                                                       " +
							"\n";
						wucha_end = wucha_end + secondsDifference_end_current + "-1    10110054 010    " + hall_name.slice(0,
								1) + name_min.slice(0, 3) + dis_version + djs_tishi_light_on +
							"                                                                                                                                                                                                                                                                                                      " +
							"\n";
						if (djs_tishi_light_on === 'ç»“æŸ||è¯·æ›´æ–°å‡†ç¡®æ—¶é—´') {
							//å¦‚æœå­˜åœ¨æ²¡æœ‰ç²¾ç¡®å¼€ç¯æ—¶é—´çš„åœºæ¬¡ï¼Œå€’è®¡æ—¶è½¯ä»¶ä¼šåœ¨ç”µå½±å¼€å§‹1å°æ—¶åæ¯åˆ†é’Ÿæç¤ºä¸€æ¬¡
							for (let x = 0; x < 10; x++) {
								var math_secondsDifference_start = Number(secondsDifference_start); //å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—
								math_secondsDifference_start = math_secondsDifference_start + 3600 + 60 *
									x; //ç¬¬ä¸€æ¬¡æç¤ºåœ¨1å°æ—¶åï¼Œä¾æ¬¡é€’åŠ 1åˆ†é’Ÿï¼Œæé†’åæ¬¡
								djs_tishi_dongzuo = '||æ›´æ–°äº®ç¯æ—¶é—´ ç»“æŸæ—¶éœ€æ‰‹åŠ¨å¼€ç¯||è‹¥TMSæœªæ›´æ–°è¯·è¯¢é—®ç»ç†æˆ–æ”¾æ˜ ';
								wucha_start = wucha_start + math_secondsDifference_start + "-1    10110054 010    " + hall_name
									.slice(0, 1) + "å… " +
									name_min.slice(0, 3) + dis_version + djs_tishi_dongzuo +
									"                                                                                                                                                                                                                                                                                                       " +
									"\n";
							}
						}
						//console.log(wucha_1h_tishi);
						wucha_all = wucha_end + wucha_start; //å€’è®¡æ—¶éœ€è¦çš„æœ€ç»ˆæ•°æ®

					}
					//console.log(wucha_all);
					//console.log(all); //å‡ºç¥¨ç»“æœç•Œé¢
					NeedCheck = removeDuplicates(NeedCheck); //ç®€åŒ–æé†’çš„åç§°ï¼Œå»æ‰é‡å¤é¡¹
					const NeedCheck_result = arrayToStringWithNewLine(NeedCheck);
					document.getElementById('checktime').innerHTML = NeedCheck_result;
					//console.log(NeedCheck);//éœ€è¦ç²¾ç¡®æ—¶é—´çš„ç”µå½±å
					// å¤„ç†æ•°æ®å¹¶æ‰“å°ç»“æœ
					const processedData = processMoviesData(moviesData);
					//console.log(processedData);
					const arrayOfArrays = processedData;
					// ä½¿ç”¨ sort() æ–¹æ³•å’Œè‡ªå®šä¹‰æ¯”è¾ƒå‡½æ•°å¯¹å†…éƒ¨æ•°ç»„æŒ‰é•¿åº¦ä»é•¿åˆ°çŸ­è¿›è¡Œæ’åº
					arrayOfArrays.sort((a, b) => b.length - a.length);
					//console.log(arrayOfArrays);
					const firstItemsJoined = arrayOfArrays.map(innerArray => innerArray[0]).join(':\n') + ":";
					//å»æ‰ï¼ˆæ•°å­—3Dï¼‰
					const targetSubstring = 'ï¼ˆæ•°å­—3Dï¼‰';
					const tihuancheng = '';
					const outputString = replaceSpecifiedString(firstItemsJoined, targetSubstring, tihuancheng);
					//console.log(firstItemsJoined); // å¤§å±å¹•ç”µå½±åç•Œé¢
					//console.log(outputString); // å¤§å±å¹•ç”µå½±åç•Œé¢ï¼Œæ²¡æœ‰æ•°å­—3D
					var alltimes = "";
					// éå†æ•°ç»„å¹¶è¾“å‡ºæ¯ä¸ªå†…éƒ¨æ•°ç»„å‰©ä½™çš„å…ƒç´ ï¼Œæ¯ä¸ªæ•°ç»„è¾“å‡ºåæ¢è¡Œ
					arrayOfArrays.forEach(innerArray => {
						// ç§»é™¤ç¬¬ä¸€ä¸ªå…ƒç´ åï¼Œå°†å‰©ä½™çš„å…ƒç´ è¿æ¥æˆå­—ç¬¦ä¸²
						const remainingItemsJoined = innerArray.slice(1).join(' ');
						alltimes = alltimes + remainingItemsJoined + "\n"
						// æ¯ä¸ªæ•°ç»„çš„è¾“å‡ºå°†åœ¨æ–°çš„ä¸€è¡Œä¸Š
					});
					//console.log(alltimes); //å¤§å±å¹•æ—¶é—´ç•Œé¢
					// å°†ç¥¨ç‰ˆè¾“å‡ºåˆ°è¾“å…¥æ¡†ï¼Œå¤åˆ¶å¹¶æ¸…ç©º
					//document.getElementById('json-input').value = all;
					//document.getElementById('json-input').select();
					//document.execCommand('copy');
					//document.getElementById('json-input').value = "";
					document.getElementById('piao').innerHTML = all;
					document.getElementById('djs').innerHTML = wucha_all;
					document.getElementById('movie_name').innerHTML = outputString;
					document.getElementById('movie_time').innerHTML = alltimes;
					//alert("æˆåŠŸ");
					if (sale_status_stop == 0) {
						var sale_status_sale_message = '';
					} else {
						var sale_status_sale_message = ' âŒ›æš‚åœåœºæ¬¡:' + sale_status_stop;
					}
					if (Plan_no == 0) {
						document.getElementById('extractField_sucess').innerHTML = 'ğŸ˜ ğŸ“…' + jsonData.data.arr_date_plan[0]
							.plan_date + ' ğŸ¬æ€»åœºæ¬¡:' + jsonData.data.arr_date_plan.length;

					} else {
						document.getElementById('extractField_sucess').innerHTML = 'ğŸ˜ ğŸ“…' + jsonData.data.arr_date_plan[0]
							.plan_date + ' ğŸ¬æ€»åœºæ¬¡:' + jsonData.data.arr_date_plan.length + ' ğŸ”’æœªé‡Šæ”¾åœºæ¬¡:' + Plan_no;
						alert("æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n" +
							"æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n" +
							"æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n" +
							"æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n" +
							"æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n" +
							"æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n" +
							"æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n" +
							"æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n" +
							"æœªé‡Šæ”¾åœºæ¬¡:" + Plan_no + "ï¼Œè¯·æé†’ç»ç†é‡Šæ”¾ï¼Œåˆ·æ–°é¡µé¢åé‡æ–°å¤åˆ¶F12çš„å†…å®¹\n"
						)
					}

				} catch (error) {
					// å¦‚æœJSONè§£æå¤±è´¥ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯
					console.error('æ— æ•ˆçš„JSONæ•°æ®:', error);
					document.getElementById('json-input').value = "";
					alert("å¤åˆ¶é”™è¯¯ï¼Œè¯·é‡æ–°å¤åˆ¶")
				}
				//setTimeout(sortTableByStartTime, 200);
				//sortTableByStartTime()
			}
		</script>
		<script>
			//å¼€å§‹ç”Ÿæˆå¤§å±å¹•æ•°æ®
			function processMoviesData(movies) {
				// å…ˆæŒ‰ç”µå½±åï¼Œå†æŒ‰å¼€åœºæ—¶é—´æ’åº
				movies.sort((a, b) => {
					if (a.display_name < b.display_name) return -1;
					if (a.display_name > b.display_name) return 1;
					return new Date(a.show_time_start) - new Date(b.show_time_start);
				});

				// ä½¿ç”¨reduceå‡½æ•°æŒ‰ç”µå½±ååˆ†ç»„å¹¶æ”¶é›†å¼€åœºæ—¶é—´
				const groupedByMovie = movies.reduce((acc, movie) => {
					if (!acc[movie.display_name]) {
						acc[movie.display_name] = [];
					}
					//acc[movie.display_name].push(movie.show_time_start);
					acc[movie.display_name].push(movie.show_time_start.slice(11, 16));
					return acc;
				}, {});

				// è½¬æ¢ä¸ºæ‰€éœ€çš„è¾“å‡ºæ ¼å¼
				const output = Object.entries(groupedByMovie).map(([movieName, showTimes]) => {
					return [movieName, ...showTimes];
				});

				return output;
			}

			function replaceSpecifiedString(inputString, targetSubstring, tihuancheng) {
				// å¯¹ç›®æ ‡å­å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œä»¥ä¾¿åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ä½¿ç”¨
				const escapedTarget = targetSubstring.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');

				// åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œä½¿ç”¨'g'æ ‡å¿—è¿›è¡Œå…¨å±€åŒ¹é…
				const regex = new RegExp(escapedTarget, 'g');

				// æ›¿æ¢æ‰€æœ‰åŒ¹é…åˆ°çš„å­å­—ç¬¦ä¸²ä¸ºç©º
				const result = inputString.replace(regex, tihuancheng);

				return result;
			}

			function copymovie_name() {
				try {
					document.getElementById('movie_name').select();
					document.execCommand('copy');
					document.getElementById('copymovie_name_sucess').innerHTML = 'ğŸ˜';
					//console.log("æˆåŠŸ1")
					//alert("å¤åˆ¶æˆåŠŸ")
				} catch (error) {
					aconsole.error('å¤åˆ¶å¤±è´¥', error);
				}
			}

			function copymovie_time() {
				try {
					document.getElementById('movie_time').select();
					document.execCommand('copy');
					document.getElementById('copymovie_time_sucess').innerHTML = 'ğŸ˜';
					//console.log("æˆåŠŸ2")
					//alert("å¤åˆ¶æˆåŠŸ")
				} catch (error) {
					console.error('å¤åˆ¶å¤±è´¥', error);
				}

			}

			function copypiao() {
				try {
					document.getElementById('piao').select();
					document.execCommand('copy');
					document.getElementById('cpoypiao_sucess').innerHTML = 'ğŸ˜';
					//console.log("æˆåŠŸ2")
					//alert("å¤åˆ¶æˆåŠŸ")
				} catch (error) {
					console.error('å¤åˆ¶å¤±è´¥', error);
				}
			}

			function copydjs() {
				try {
					document.getElementById('djs').select();
					document.execCommand('copy');
					document.getElementById('copy_djs_sucess').innerHTML = 'ğŸ˜';
					//console.log("æˆåŠŸ2")
					//alert("å¤åˆ¶æˆåŠŸ")
				} catch (error) {
					console.error('å¤åˆ¶å¤±è´¥', error);
				}
			}

			function copybyds() {
				try {
					document.getElementById('byds').select();
					document.execCommand('copy');
					document.getElementById('copy_byds_sucess').innerHTML = 'ğŸ˜';
					//console.log("æˆåŠŸ2")
					//alert("å¤åˆ¶æˆåŠŸ")
				} catch (error) {
					console.error('å¤åˆ¶å¤±è´¥', error);
				}
			}
			//å‰å°ï¼šæŒ‰ç…§ç”µå½±åæ’åº
			function QTname() {
				// å‡è®¾ä½ å·²ç»æœ‰äº†ä¸€ä¸ªè¡¨æ ¼å…ƒç´ ï¼Œå…¶idä¸º"myTable"
				const table = document.getElementById('tableContainer').getElementsByTagName("table")[0];

				// è·å–è¡¨æ ¼ä¸­çš„æ‰€æœ‰è¡Œï¼ˆé™¤äº†è¡¨å¤´ï¼‰
				const rows = Array.from(table.rows).slice(1); // æ’é™¤ç¬¬ä¸€è¡Œï¼Œé€šå¸¸æ˜¯è¡¨å¤´

				// æå–æŸä¸€åˆ—ï¼ˆä¾‹å¦‚ï¼Œç¬¬äºŒåˆ—ï¼‰çš„æ•°æ®å¹¶è¿›è¡Œæ’åº
				// è¿™é‡Œæˆ‘ä»¬å‡è®¾æ’åºçš„åˆ—åŒ…å«æ–‡æœ¬æ•°æ®ï¼Œå¹¶ä½¿ç”¨å­—ç¬¦ä¸²çš„localeCompareè¿›è¡Œæ’åº
				const columnData = rows.map(row => row.cells[2].textContent); // è·å–ç¬¬ä¸‰åˆ—çš„æ•°æ®
				const sortedIndices = columnData.map((_, index) => index).sort((a, b) => columnData[a].localeCompare(columnData[
					b])); // è·å–æ’åºåçš„ç´¢å¼•

				// æ ¹æ®æ’åºåçš„ç´¢å¼•é‡æ–°æ’åˆ—è¡Œ
				const sortedRows = sortedIndices.map(index => rows[index]);

				// æ¸…ç©ºè¡¨æ ¼ä½“ï¼Œç„¶åé‡æ–°æ·»åŠ æ’åºåçš„è¡Œ
				const tbody = table.tBodies[0]; // è·å–è¡¨æ ¼ä½“å…ƒç´ 
				while (tbody.firstChild) {
					tbody.removeChild(tbody.firstChild); // æ¸…ç©ºè¡¨æ ¼ä½“
				}
				sortedRows.forEach(row => tbody.appendChild(row)); // æ·»åŠ æ’åºåçš„è¡Œ
			}

			function sortTableByStartTime() {
				extractField();
				xianshi_button_deleteMovie();
				var table, rows, switching, i, x, y, shouldSwitch;
				table = document.getElementById("tableContainer").getElementsByTagName("table")[0];
				switching = true;
				while (switching) {
					switching = false;
					rows = table.getElementsByTagName("tr");
					for (i = 1; i < (rows.length - 1); i++) {
						shouldSwitch = false;
						x = rows[i].getElementsByTagName("td")[0].innerHTML;
						y = rows[i + 1].getElementsByTagName("td")[0].innerHTML;
						if (x.toLowerCase() > y.toLowerCase()) {
							shouldSwitch = true;
							break;
						}
					}
					if (shouldSwitch) {
						rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
						switching = true;
					}
				}
				var tbody = table.querySelector('tbody');

				// éå†tbodyä¸­çš„æ¯ä¸€è¡Œ
				var rows = tbody.querySelectorAll('tr');
				rows.forEach(function(row) {
					// è·å–å½“å‰è¡Œçš„ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—å…ƒç´ 
					var firstCell = row.querySelector('td:nth-child(1)');
					var secondCell = row.querySelector('td:nth-child(2)');

					// ç¡®ä¿è¿™ä¸¤ä¸ªå•å…ƒæ ¼å­˜åœ¨
					if (firstCell && secondCell) {
						// è·å–ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—çš„å†…å®¹
						var firstContent = firstCell.textContent || firstCell.innerText;
						var secondContent = secondCell.textContent || secondCell.innerText;

						// å¦‚æœå†…å®¹é•¿åº¦å¤§äº11ï¼Œåˆ™åˆ é™¤å‰11ä¸ªå­—ç¬¦
						if (firstContent.length > 11) {
							firstCell.textContent = firstContent.slice(11, 16);
						}
						if (secondContent.length > 11) {
							secondCell.textContent = secondContent.slice(11, 16);
						}
					}
				});
				console.log('å¼€å§‹æ—¶é—´æ’åº');
			}

			function sortTableByEndTime() { //ä¿æ´è¡¨
				extractField();
				yincang_deleteMovie()
				var table, rows, switching, i, x, y, shouldSwitch;
				table = document.getElementById("tableContainer").getElementsByTagName("table")[0];
				switching = true;
				while (switching) {
					switching = false;
					rows = table.getElementsByTagName("tr");
					for (i = 1; i < (rows.length - 1); i++) {
						shouldSwitch = false;
						x = rows[i].getElementsByTagName("td")[1].innerHTML;
						y = rows[i + 1].getElementsByTagName("td")[1].innerHTML;
						if (x.toLowerCase() > y.toLowerCase()) {
							shouldSwitch = true;
							break;
						}
					}
					if (shouldSwitch) {
						rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
						switching = true;
					}
				}
				var tbody = table.querySelector('tbody');

				// éå†tbodyä¸­çš„æ¯ä¸€è¡Œ
				var rows = tbody.querySelectorAll('tr');
				rows.forEach(function(row) {
					// è·å–å½“å‰è¡Œçš„ç¬¬ä¸€åˆ—,ç¬¬äºŒåˆ—,ç¬¬ä¸‰åˆ—å…ƒç´ 
					var firstCell = row.querySelector('td:nth-child(1)');
					var secondCell = row.querySelector('td:nth-child(2)');
					var thirdCell = row.querySelector('td:nth-child(3)');
					// ç¡®ä¿è¿™ä¸¤ä¸ªå•å…ƒæ ¼å­˜åœ¨
					if (firstCell && secondCell && thirdCell) {
						// è·å–ç¬¬ä¸€åˆ—,ç¬¬äºŒåˆ—,ç¬¬ä¸‰åˆ—çš„å†…å®¹
						var firstContent = firstCell.textContent || firstCell.innerText;
						var secondContent = secondCell.textContent || secondCell.innerText;
						var thiredContent = thirdCell.textContent || thirdCell.innerText;
						var stringsToReplace = ['ï¼ˆæ—¥è¯­ï¼‰', 'ï¼ˆè‹±è¯­ï¼‰', 'ï¼ˆå…¶ä»–ï¼‰', 'ï¼ˆå°åº¦è¯­ï¼‰', 'ï¼ˆå°å°¼è¯­ï¼‰', 'ï¼ˆæ³•è¯­ï¼‰', 'ï¼ˆæ„å¤§åˆ©è¯­ï¼‰', 'ï¼ˆéŸ©è¯­ï¼‰',
							'ï¼ˆä¿„è¯­ï¼‰', 'ğŸŒ',
							'3DğŸ‘“', ' '
						];
						var originalString = thiredContent;
						//console.log(originalString);
						thiredContent = replaceMatchesWithEmptyString(originalString, stringsToReplace);
						//console.log(thiredContent);
						const result_thiredContent = processMovieString(thiredContent);
						//console.log(result_thiredContent);
						if (result_thiredContent == null || result_thiredContent.lightOnTime == undefined ||
							result_thiredContent.posterTime == undefined || result_thiredContent.lightOnTime == '' ||
							result_thiredContent.posterTime == '') {
							console.log("æœªæŸ¥è¯¢åˆ° " + thiredContent + " å…·ä½“ç»“æŸæ—¶é—´")
							thiredContent = "â–ˆ" + thiredContent;
						} else if (result_thiredContent.lightOnTime !== undefined || result_thiredContent.posterTime !==
							undefined) {
							// åˆå§‹æœ¬åœ°æ—¶é—´å­—ç¬¦ä¸²ï¼ˆISO 8601 æ ¼å¼ï¼Œæ— æ—¶åŒºä¿¡æ¯ï¼‰
							const initialTimeString = firstContent;

							// å°†æ—¶é—´å­—ç¬¦ä¸²è½¬æ¢ä¸º Date å¯¹è±¡
							const initialDate = new Date(initialTimeString);

							// å¢åŠ ã€å‡å°‘çš„æœ¬åœ°æ—¶é—´å­—ç¬¦ä¸²
							const timeToAddString = result_thiredContent.lightOnTime; //å¢åŠ æ—¶é—´
							const timeToSubtractString = result_thiredContent.posterTime; //å‡å°‘æ—¶é—´
							// è§£æå¹¶å¢åŠ ã€å‡å°‘æ—¶é—´
							const [hoursToAdd_lightOnTime, minutesToAdd_lightOnTime, secondsToAdd_lightOnTime] =
							timeToAddString.split(':').map(Number); //äº®ç¯æ—¶é—´
							const millisecondsToAdd = (hoursToAdd_lightOnTime * 3600000) + (minutesToAdd_lightOnTime *
								60000) + (secondsToAdd_lightOnTime * 1000); //å¢åŠ    æ ¼å¼åŒ–äº®ç¯æ—¶é—´
							const [hoursToSubtract_posterTime, minutesToSubtract_posterTime,
								secondsToSubtract_posterTime
							] = timeToSubtractString.split(':').map(Number); //é¾™æ ‡æ—¶é—´
							const millisecondsToSubtract = (hoursToSubtract_posterTime * 3600000) + (
								minutesToSubtract_posterTime * 60000) + (secondsToSubtract_posterTime *
								1000); //å‡å°‘  æ ¼å¼åŒ–é¾™æ ‡æ—¶é—´
							initialDate.setTime(initialDate.getTime() + millisecondsToAdd -
								millisecondsToSubtract); //æ­£ç¡®äº®ç¯æ—¶é—´=å¼€å§‹æ—¶é—´+äº®ç¯æ—¶é—´(åŒ…æ‹¬å¹¿å‘Š)-é¾™æ ‡æ—¶é—´

							// æ‰‹åŠ¨æ„å»º ISO 8601 æ ¼å¼çš„è¾“å‡ºå­—ç¬¦ä¸²ï¼ˆæ— æ—¶åŒºä¿¡æ¯ï¼‰
							const year = initialDate.getFullYear();
							const month = String(initialDate.getMonth() + 1).padStart(2, '0'); // æœˆä»½ä»0å¼€å§‹ï¼Œéœ€è¦åŠ 1
							const day = String(initialDate.getDate()).padStart(2, '0');
							const hours = String(initialDate.getHours()).padStart(2, '0');
							const minutes = String(initialDate.getMinutes()).padStart(2, '0');
							const seconds = String(initialDate.getSeconds()).padStart(2, '0');
							const resultTimeString = `${year}-${month}-${day}T${hours}:${minutes}:${seconds}`;
							//console.log(thiredContent.slice(0, 9) + " ä¸¨ " + firstContent.slice(11, 16) + " ä¸¨ " + secondContent.slice(11, 16) + " ä¸¨ " + resultTimeString.slice(11, 16))
							secondContent = resultTimeString;
						}
						// å¦‚æœå†…å®¹é•¿åº¦å¤§äº11ï¼Œåˆ™åˆ é™¤å‰11ä¸ªå­—ç¬¦
						if (firstContent.length > 11) {
							firstCell.textContent = firstContent.slice(11, 16);
						}
						if (secondContent.length > 11) {
							secondCell.textContent = secondContent.slice(11, 16);
						}
						//é˜²æ­¢ç”µå½±åè¿‡é•¿ï¼Œåªæ˜¾ç¤ºå‰ä¹ä¸ªå­—
						thirdCell.textContent = thiredContent.slice(0, 9);
					}
				});
				splitTable();
				xianshi();
				console.log('ç»“æŸæ—¶é—´æ’åº');
			}

			function sortTableByMovie() {
				yincang_deleteMovie()
				extractField();
				var table, rows, switching, i, x, y, shouldSwitch;
				table = document.getElementById("tableContainer").getElementsByTagName("table")[0];
				switching = true;
				while (switching) {
					switching = false;
					rows = table.getElementsByTagName("tr");
					for (i = 1; i < (rows.length - 1); i++) {
						shouldSwitch = false;
						x = rows[i].getElementsByTagName("td")[2].innerHTML;
						y = rows[i + 1].getElementsByTagName("td")[2].innerHTML;
						if (x.toLowerCase() > y.toLowerCase()) {
							shouldSwitch = true;
							break;
						}
					}
					if (shouldSwitch) {
						rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
						switching = true;
					}
				}
				var tbody = table.querySelector('tbody');

				// éå†tbodyä¸­çš„æ¯ä¸€è¡Œ
				var rows = tbody.querySelectorAll('tr');
				rows.forEach(function(row) {
					// è·å–å½“å‰è¡Œçš„ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—å…ƒç´ 
					var firstCell = row.querySelector('td:nth-child(1)');
					var secondCell = row.querySelector('td:nth-child(2)');

					// ç¡®ä¿è¿™ä¸¤ä¸ªå•å…ƒæ ¼å­˜åœ¨
					if (firstCell && secondCell) {
						// è·å–ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—çš„å†…å®¹
						var firstContent = firstCell.textContent || firstCell.innerText;
						var secondContent = secondCell.textContent || secondCell.innerText;

						// å¦‚æœå†…å®¹é•¿åº¦å¤§äº11ï¼Œåˆ™åˆ é™¤å‰11ä¸ªå­—ç¬¦
						if (firstContent.length > 11) {
							firstCell.textContent = firstContent.slice(11, 16);
						}
						if (secondContent.length > 11) {
							secondCell.textContent = secondContent.slice(11, 16);
						}
					}
				});
				console.log('ç”µå½±åæ’åº');
				deleteCheckbox();
			}

			function sortTableByCellName() {
				yincang_deleteMovie()
				extractField();
				var table, rows, switching, i, x, y, shouldSwitch;
				table = document.getElementById("tableContainer").getElementsByTagName("table")[0];
				switching = true;
				while (switching) {
					switching = false;
					rows = table.getElementsByTagName("tr");
					for (i = 1; i < (rows.length - 1); i++) {
						shouldSwitch = false;
						x = rows[i].getElementsByTagName("td")[3].innerHTML;
						y = rows[i + 1].getElementsByTagName("td")[3].innerHTML;
						if (x.toLowerCase() > y.toLowerCase()) {
							shouldSwitch = true;
							break;
						}
					}
					if (shouldSwitch) {
						rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
						switching = true;
					}
				}
				var tbody = table.querySelector('tbody');

				// éå†tbodyä¸­çš„æ¯ä¸€è¡Œ
				var rows = tbody.querySelectorAll('tr');
				rows.forEach(function(row) {
					// è·å–å½“å‰è¡Œçš„ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—å…ƒç´ 
					var firstCell = row.querySelector('td:nth-child(1)');
					var secondCell = row.querySelector('td:nth-child(2)');

					// ç¡®ä¿è¿™ä¸¤ä¸ªå•å…ƒæ ¼å­˜åœ¨
					if (firstCell && secondCell) {
						// è·å–ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—çš„å†…å®¹
						var firstContent = firstCell.textContent || firstCell.innerText;
						var secondContent = secondCell.textContent || secondCell.innerText;

						// å¦‚æœå†…å®¹é•¿åº¦å¤§äº11ï¼Œåˆ™åˆ é™¤å‰11ä¸ªå­—ç¬¦
						if (firstContent.length > 11) {
							firstCell.textContent = firstContent.slice(11, 16);
						}
						if (secondContent.length > 11) {
							secondCell.textContent = secondContent.slice(11, 16);
						}
					}
				});
				console.log('å…åæ’åº');
				deleteCheckbox();
			}

			function jianhua_time() {
				// è·å–è¡¨æ ¼å…ƒç´ 
				var table = document.querySelector('#tableContainer table');
				// è·å–è¡¨æ ¼çš„tbodyå…ƒç´ 
				var tbody = table.querySelector('tbody');

				// éå†tbodyä¸­çš„æ¯ä¸€è¡Œ
				var rows = tbody.querySelectorAll('tr');
				rows.forEach(function(row) {
					// è·å–å½“å‰è¡Œçš„ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—å…ƒç´ 
					var firstCell = row.querySelector('td:nth-child(1)');
					var secondCell = row.querySelector('td:nth-child(2)');

					// ç¡®ä¿è¿™ä¸¤ä¸ªå•å…ƒæ ¼å­˜åœ¨
					if (firstCell && secondCell) {
						// è·å–ç¬¬ä¸€åˆ—å’Œç¬¬äºŒåˆ—çš„å†…å®¹
						var firstContent = firstCell.textContent || firstCell.innerText;
						var secondContent = secondCell.textContent || secondCell.innerText;

						// å¦‚æœå†…å®¹é•¿åº¦å¤§äº11ï¼Œåˆ™åˆ é™¤å‰11ä¸ªå­—ç¬¦
						if (firstContent.length > 11) {
							firstCell.textContent = firstContent.slice(11, 16);
						}
						if (secondContent.length > 11) {
							secondCell.textContent = secondContent.slice(11, 16);
						}
					}
				});
			}
			// ç”µå½±ä¿¡æ¯æ•°ç»„
			/*const movies = [{
					name: "é£é©°äººç”Ÿ2",
					nickname: "é£2",
					lightOnTime: "02:01:00",
					posterTime: "00:04:25"
				},{
					name: "é£é©°äººç”Ÿ2",
					nickname: "é£2",
					lightOnTime: "02:01:00",
					posterTime: "00:04:25"
				},
				// å¯ä»¥ç»§ç»­æ·»åŠ å…¶ä»–ç”µå½±ä¿¡æ¯
			];*/
			//console.log(movies);
			// è®¡ç®—æ—¶é—´å·®çš„å‡½æ•°
			function calculateTimeDifference(lightOnTime, posterTime) { //ç»“æŸæ—¶é—´ï¼Œé¾™æ ‡æ—¶é—´
				const lightOnDate = new Date(`1970-01-01T${lightOnTime}Z`);
				const posterDate = new Date(`1970-01-01T${posterTime}Z`);
				return Math.round((lightOnDate - posterDate) / 1000); // è¿”å›ç§’æ•°
			}

			// å¤„ç†å­—ç¬¦ä¸²ä¸ç”µå½±ååŒ¹é…ï¼Œå¹¶è¿”å›æ˜µç§°å’Œæ—¶é—´å·®çš„å‡½æ•°
			function processMovieString(inputString) {
				for (const movie of movies) {
					//console.log(movies);
					if (movie.name === inputString) {
						const timeDifference = calculateTimeDifference(movie.lightOnTime, movie.posterTime);
						return {
							name: movie.name,
							nickname: movie.nickname,
							timeDifference,
							lightOnTime: movie.lightOnTime,
							posterTime: movie.posterTime
						};
					}
					//console.log(movie.name + "----" + movie.lightOnTime)
				}
				// å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„ç”µå½±ï¼Œå¯ä»¥è¿”å›nullæˆ–å…¶ä»–å€¼
				return null;
			}

			function readFile() {
				const fileInput = document.getElementById('excel-file');
				const file = fileInput.files[0];

				if (!file) {
					console.log("æœªé€‰æ‹©æ–‡ä»¶");
					return;
				}

				const reader = new FileReader();
				reader.onload = function(e) {
					const data = new Uint8Array(e.target.result);
					const workbook = XLSX.read(data, {
						type: 'array'
					});

					// å‡è®¾ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨åŒ…å«æ‰€éœ€æ•°æ®
					const worksheetName = workbook.SheetNames[0];
					const worksheet = workbook.Sheets[worksheetName];

					// å°†å·¥ä½œè¡¨è½¬æ¢ä¸ºJSONå¯¹è±¡æ•°ç»„
					var jsonData_excel = XLSX.utils.sheet_to_json(worksheet, {
						header: 1
					}); // header: 1 è¡¨ç¤ºç¬¬ä¸€è¡Œæ˜¯æ ‡é¢˜è¡Œ

					// æ‰“å°è¯»å–åˆ°çš„å†…å®¹
					//
					jsonData_excel = jsonData_excel.map(function(subArray) {
						// è½¬æ¢å­æ•°ç»„ä¸ºå¯¹è±¡
						return {
							name: subArray[0], // å‡è®¾ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯nameï¼Œç”µå½±å
							nickname: subArray[1], // å‡è®¾ç¬¬äºŒä¸ªå…ƒç´ æ˜¯nicknameï¼Œç”µå½±æ˜µç§°
							lightOnTime: subArray[2], // å‡è®¾ç¬¬ä¸‰ä¸ªå…ƒç´ æ˜¯lightOnTimeï¼Œç»“æŸæ—¶é—´
							posterTime: subArray[3] // å‡è®¾ç¬¬å››ä¸ªå…ƒç´ æ˜¯posterTimeï¼Œé¾™æ ‡æ—¶é—´
						};
					});
					//console.log(jsonData_excel);
					//console.log(movies);
					movies = jsonData_excel;
					//console.log(movies);

				};
				reader.readAsArrayBuffer(file);
				document.getElementById('readFile_sucess').innerHTML = "ğŸ˜ğŸ‘‰"
			}

			function printDiv() {
				var printArea = document.getElementById('tableContainer');
				var printFrame = document.getElementById('printFrame');
				var printWindow = printFrame.contentWindow || printFrame.contentDocument.document;

				// è®¾ç½®iframeçš„å®½é«˜ä»¥åŒ¹é…æ‰“å°divçš„å®½é«˜
				printFrame.style.width = printArea.offsetWidth + 'px';
				printFrame.style.height = printArea.offsetHeight + 'px';

				// å°†divçš„å†…å®¹å†™å…¥iframeçš„documentä¸­
				printWindow.document.open();
				printWindow.document.write(
					'<html><head><title>æ‰“å°å†…å®¹</title><style>' +
					/* åœ¨è¿™é‡Œå¤åˆ¶æ‰“å°æ ·å¼ */
					'</style></head><body>' +
					printArea.innerHTML +
					'</body></html>'
				);
				deleteCheckbox();
				printWindow.document.close();

				// æ‰“å°iframeçš„å†…å®¹
				printWindow.focus(); // ç¡®ä¿iframeè·å¾—ç„¦ç‚¹
				printWindow.print();
			}

			function printDivZao() {
				var printArea = document.getElementById('splitTables_1');
				var printFrame = document.getElementById('printFrame');
				var printWindow = printFrame.contentWindow || printFrame.contentDocument.document;

				// è®¾ç½®iframeçš„å®½é«˜ä»¥åŒ¹é…æ‰“å°divçš„å®½é«˜
				printFrame.style.width = printArea.offsetWidth + 'px';
				printFrame.style.height = printArea.offsetHeight + 'px';

				// å°†divçš„å†…å®¹å†™å…¥iframeçš„documentä¸­
				printWindow.document.open();
				printWindow.document.write(
					'<html><head><title>æ‰“å°å†…å®¹</title><style>' +
					/* åœ¨è¿™é‡Œå¤åˆ¶æ‰“å°æ ·å¼ */
					'</style></head><body>' +
					printArea.innerHTML +
					'</body></html>'
				);
				printWindow.document.close();
				// æ‰“å°iframeçš„å†…å®¹
				printWindow.focus(); // ç¡®ä¿iframeè·å¾—ç„¦ç‚¹
				printWindow.print();
			}

			function printDivWan() {
				var printArea = document.getElementById('splitTables_2');
				var printFrame = document.getElementById('printFrame');
				var printWindow = printFrame.contentWindow || printFrame.contentDocument.document;

				// è®¾ç½®iframeçš„å®½é«˜ä»¥åŒ¹é…æ‰“å°divçš„å®½é«˜
				printFrame.style.width = printArea.offsetWidth + 'px';
				printFrame.style.height = printArea.offsetHeight + 'px';

				// å°†divçš„å†…å®¹å†™å…¥iframeçš„documentä¸­
				printWindow.document.open();
				printWindow.document.write(
					'<html><head><title>æ‰“å°å†…å®¹</title><style>' +
					/* åœ¨è¿™é‡Œå¤åˆ¶æ‰“å°æ ·å¼ */
					'</style></head><body>' +
					printArea.innerHTML +
					'</body></html>'
				);
				printWindow.document.close();
				// æ‰“å°iframeçš„å†…å®¹
				printWindow.focus(); // ç¡®ä¿iframeè·å¾—ç„¦ç‚¹
				printWindow.print();
			}
			//åŸå§‹å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šéœ€è¦æ›¿æ¢ä¸ºç©ºçš„å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„  åŸå§‹å­—ç¬¦ä¸²ï¼šoriginalString    éœ€è¦æ›¿æ¢çš„å­—ç¬¦ä¸²ç»„ï¼šstringsToReplace
			function replaceMatchesWithEmptyString(originalString, stringsToReplace) {
				// éå†å­—ç¬¦ä¸²æ•°ç»„
				stringsToReplace.forEach(function(str) {
					// ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å’Œå…¨å±€æœç´¢æ ‡å¿—æ›¿æ¢æ‰€æœ‰åŒ¹é…é¡¹
					var regex = new RegExp(str, 'g');
					originalString = originalString.replace(regex, '');
				});

				// è¿”å›æ›¿æ¢åçš„å­—ç¬¦ä¸²
				return originalString;
			}
			//å»æ‰æ•°ç»„ä¸­ç›¸åŒçš„æ•°æ®
			function removeDuplicates(array) {
				return Array.from(new Set(array));
			}

			function arrayToStringWithNewLine(array) {
				// ä½¿ç”¨mapæ–¹æ³•å°†æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºå­—ç¬¦ä¸²  
				const stringArray = array.map(item => String(item));
				// ä½¿ç”¨joinæ–¹æ³•å°†æ‰€æœ‰å­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼Œå…ƒç´ ä¹‹é—´ç”¨æ¢è¡Œç¬¦è¿æ¥
				const result = stringArray.join('\n');
				return result;
			}
			//æ‹†åˆ†è¡¨æ ¼
			function splitTable() {
				// è·å–åŸå§‹è¡¨æ ¼
				var originalTable = document.getElementById('tableContainer_div');
				deleteCheckbox();
				var rows = Array.from(originalTable.tBodies[0].rows);
				// åˆ›å»ºæ–°è¡¨æ ¼çš„å®¹å™¨
				var splitTablesContainer_1 = document.getElementById('splitTables_1');
				var splitTablesContainer_2 = document.getElementById('splitTables_2');
				splitTablesContainer_1.innerHTML = ''; // æ¸…ç©ºå®¹å™¨å†…å®¹
				splitTablesContainer_2.innerHTML = ''; // æ¸…ç©ºå®¹å™¨å†…å®¹
				// åˆ›å»ºä¸¤ä¸ªæ–°è¡¨æ ¼
				var table1 = document.createElement('table');
				var table2 = document.createElement('table');
				table1.style.borderCollapse = 'collapse';
				table1.style.fontSize = 'smaller';
				table1.id = 'tableContainer_div1';
				table2.style.borderCollapse = 'collapse';
				table2.style.fontSize = 'smaller';
				table2.id = 'tableContainer_div2';
				// æ£€æŸ¥æ˜¯å¦å­˜åœ¨è¡¨å¤´ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºå®ƒ
				var thead;
				if (originalTable.tHead) {
					thead = originalTable.tHead.cloneNode(true); // å…‹éš†è¡¨å¤´
				} else {
					thead = document.createElement('thead');
					var firstRow = originalTable.tBodies[0].rows[0].cloneNode(true);
					thead.appendChild(firstRow);
				}

				// ä¸ºä¸¤ä¸ªæ–°è¡¨æ ¼æ·»åŠ è¡¨å¤´
				table1.appendChild(thead.cloneNode(true));
				table2.appendChild(thead.cloneNode(true));

				// æ‹†åˆ†è¡¨æ ¼è¡Œå¹¶æ·»åŠ åˆ°æ–°è¡¨æ ¼ä¸­
				rows.forEach(row => {
					var endTime = row.cells[1].textContent;
					var isBetween5And1630 = endTime >= '05:00' && endTime < '16:30';
					var newRow = row.cloneNode(true); // å…‹éš†è¡Œ
					if (isBetween5And1630) {
						// ç¡®ä¿table1æœ‰tbody
						if (!table1.tBodies.length) {
							var tbody = document.createElement('tbody');
							table1.appendChild(tbody);
						}
						table1.tBodies[0].appendChild(newRow); // æ·»åŠ åˆ°ç¬¬äºŒä¸ªè¡¨æ ¼
					} else {
						// ç¡®ä¿table2æœ‰tbody
						if (!table2.tBodies.length) {
							var tbody = document.createElement('tbody');
							table2.appendChild(tbody);
						}
						table2.tBodies[0].appendChild(newRow); // æ·»åŠ åˆ°ç¬¬ä¸€ä¸ªè¡¨æ ¼
					}
				});

				// å°†æ–°è¡¨æ ¼æ·»åŠ åˆ°å®¹å™¨ä¸­
				splitTablesContainer_1.appendChild(table1);
				//splitTablesContainer.appendChild(document.createElement('br')); // æ·»åŠ æ¢è¡Œ
				splitTablesContainer_2.appendChild(table2);
			}

			function yincang() {
				var zaoban = document.getElementById('zao');
				var wanban = document.getElementById('wan');
				zaoban.style.display = 'none';
				wanban.style.display = 'none';
			}

			function xianshi() {
				var zaoban = document.getElementById('zao');
				var wanban = document.getElementById('wan');
				zaoban.style.display = 'inline-table';
				wanban.style.display = 'inline-table';
			}

			function xianshi_button_deleteMovie() {
				var xianshi_button_deleteMovie = document.getElementById('button_deleteMovie');
				xianshi_button_deleteMovie.style.display = '';
			}

			// åˆ é™¤ä¸éœ€è¦çš„è™šæ‹Ÿåœºæ¬¡ï¼Œå¤„ç†å¤šé€‰æ¡†é€‰ä¸­çŠ¶æ€çš„å‡½æ•°
			function deleteFalseMovie() {

				// åˆå§‹åŒ–å­˜å‚¨é€‰ä¸­å€¼çš„æ•°ç»„
				//const selectedValues = [];

				// è·å–è¡¨æ ¼ä¸­çš„æ‰€æœ‰å¤šé€‰æ¡†  
				const checkboxes = document.querySelectorAll('#tableContainer_div tbody input[type="checkbox"]');
				//console.log(checkboxes);
				// æ¸…ç©ºæ•°ç»„ï¼ˆå¦‚æœéœ€è¦ä¿ç•™ä¹‹å‰çš„çŠ¶æ€ï¼Œåˆ™ç§»é™¤è¿™è¡Œä»£ç ï¼‰  
				//indicesToDelete.length = 0;

				// éå†æ‰€æœ‰å¤šé€‰æ¡†ï¼Œæ£€æŸ¥å…¶é€‰ä¸­çŠ¶æ€  
				checkboxes.forEach(checkbox => {
					if (checkbox.checked) {
						indicesToDelete.push(checkbox.value);
					}
				});
				sortTableByStartTime()
			}

			//åˆ é™¤æ‰“å°æ—¶ä¼šå‡ºç°çš„å¤šé€‰æ¡†
			function deleteCheckbox() {
				// è·å–è¡¨æ ¼å…ƒç´   
				const table = document.getElementById('tableContainer_div');
				const tbody = table.tBodies[0]; // è·å–ç¬¬ä¸€ä¸ªtbodyå…ƒç´   
				const thead = table.tHead; // è·å–è¡¨å¤´  

				// åˆ é™¤è¡¨å¤´ä¸­çš„æœ€åä¸€åˆ—  
				const headerRow = thead.rows[0];
				headerRow.deleteCell(-1); // -1è¡¨ç¤ºåˆ é™¤æœ€åä¸€åˆ—  

				// åˆ é™¤æ¯ä¸€è¡Œæ•°æ®ä¸­çš„æœ€åä¸€åˆ—  
				for (let i = 0; i < tbody.rows.length; i++) {
					tbody.rows[i].deleteCell(-1);
				}
			}

			function start() {
				document.getElementById('json-input').value = document.getElementById('start').value;
				sortTableByStartTime();

			}

			function yincang_deleteMovie() {
				var button_deleteMovie = document.getElementById('button_deleteMovie');
				button_deleteMovie.style.display = 'none';
			}

			// å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥è¯»å– JSON æ–‡ä»¶
			window.onload = async function fetchMovies() {
				try {
					const response = await fetch('time.json'); // è¯»å–åŒè·¯å¾„ä¸‹çš„ time.json æ–‡ä»¶
					if (!response.ok) {
						throw new Error('Network response was not ok');
					}
					const data = await response.json(); // å°†å“åº”è§£æä¸º JSON
					// å°† JSON æ•°æ®èµ‹ç»™ movies_timejson å˜é‡ï¼Œå¹¶è°ƒç”¨ function2
					const movies_timejson = data;
					getMovies_timejson(movies_timejson);
				} catch (error) {
					console.error('There was a problem with the fetch operation:', error);
				}
			}
		</script>
	</head>
	<body>

		<h1>æ’ç‰‡ä¿¡æ¯æå–</h1>
		<textarea id="start" cols="60" rows="10" style="display: none;"></textarea>
		<button id="copyButton">ç²˜è´´</button>
		<button onclick="extractField()">è§£æ</button>
		<div style="display: inline" id="extractField_sucess"></div>
		<br>
		<textarea id="json-input" rows="3" cols="60" placeholder="æ…§å½±äº‘æ’æœŸç•Œé¢<F12>,å¤åˆ¶ä¹‹åç›´æ¥å³é”®ç²˜è´´æˆ–ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®"></textarea>
		<br><br>
		<div style="display: inline-table">
			<button onclick="copypiao()">ã€å¤åˆ¶ã€‘ç¥¨</button>
			<div style="display: inline" id="cpoypiao_sucess"></div>
			<br>
			<textarea id="piao" rows="8" cols="60"></textarea>
		</div>
		<div style="display: inline-table;width: min-content;">
			<input type="file" id="excel-file" accept=".xlsx, .xls" style="width: 40%;">
			<button onclick="readFile()">ç¡®å®š</button>
			<div style="display: inline" id="readFile_sucess"></div>
			<button onclick="extractField()">è§£æ</button>
			<button onclick="copydjs()" style="float: right;">ã€å¤åˆ¶ã€‘å€’è®¡æ—¶</button>
			<div style="display: inline;float: right;" id="copy_djs_sucess"></div>
			<br>
			<textarea id="djs" rows="8" cols="60"></textarea>
		</div>
		<div style="display: inline-table;width: min-content;">
			<span style="display: inline-table; height: 23px; color: red;">ğŸ› ğŸ› éœ€è¦ç²¾ç¡®æ—¶é—´çš„ç”µå½±ğŸ› ğŸ› </span>
			<textarea id="checktime" rows="8" cols="40" style="color: red;"></textarea>
		</div>

		<br><br>
		<div style="display: inline-table">
			<button onclick="copymovie_name()">ã€å¤åˆ¶ã€‘å¤§å±å¹•:ç”µå½±å</button>
			<div style="display: inline" id="copymovie_name_sucess"></div>
			<br>
			<textarea id="movie_name" rows="8" cols="60"></textarea>
		</div>
		<div style="display: inline-table;width: min-content;">
			<button style="float: right;" onclick="copybyds()">ã€å¤åˆ¶ã€‘æ’­éŸ³å¤§å¸ˆ</button>
			<div style="display: inline;float: right;" id="copy_byds_sucess"></div>
			<br>
			<textarea id="byds" rows="8" cols="60"></textarea>
		</div>
		<br><br>
		<button onclick="copymovie_time()">ã€å¤åˆ¶ã€‘å¤§å±å¹•:æ—¶é—´</button>
		<div style="display: inline" id="copymovie_time_sucess"></div>
		<br>
		<textarea id="movie_time" rows="8" cols="60"></textarea>
		<br><br>
		<div style="width: fit-content;" id="alltable">
			<div>
				<button onclick="sortTableByStartTime()">åˆ·æ–°</button>
				<button onclick="sortTableByMovie()">å‰å°</button>
				<button onclick="sortTableByEndTime()">ä¿æ´</button>
				<button onclick="sortTableByCellName()">å½±å…</button>
				<button onclick="start()">é‡ç½®</button>
			</div>
			<br>

			<div style="display: inline-table;text-align: center;">
				<button onclick="printDiv()">æ‰“å°å½“å‰è¡¨æ ¼(å…¨å¤©)</button>
				<button onclick="deleteFalseMovie()" style="float:right;" id="button_deleteMovie">åˆ é™¤é€‰ä¸­åœºæ¬¡</button>
				<div id="tableContainer"></div>
			</div>
			<div style="display: inline-table;padding-left: 50px;"></div>
			<div style="display: inline-table;text-align: center;" id="zao">
				<button onclick="printDivZao()">æ‰“å°æ—©ç­</button>
				<div id="splitTables_1"></div>
			</div>
			<div style="display: inline-table;padding-left: 50px;"></div>
			<div style="display: inline-table;text-align: center;" id="wan">
				<button onclick="printDivWan()">æ‰“å°æ™šç­</button>
				<div id="splitTables_2"></div>
			</div>
		</div>
		<iframe id="printFrame" src="about:blank"></iframe>
		<script>
			// å½“é¡µé¢åŠ è½½å®Œæˆæ—¶ï¼Œè‡ªåŠ¨èšç„¦åˆ°æ–‡æœ¬åŒºåŸŸ
			document.getElementById('json-input').focus();
			document.getElementById('copyButton').addEventListener('click', function() {
					// å°è¯•ä»å‰ªè´´æ¿è·å–æ–‡æœ¬
					navigator.clipboard.readText()
						.then(text => {
							// å¦‚æœæˆåŠŸè·å–åˆ°æ–‡æœ¬ï¼Œå°†å…¶å¤åˆ¶åˆ°è¾“å…¥æ¡†
							document.getElementById('json-input').value = text;
							//extractField();
						})
						.catch(err => {
							// å¦‚æœè·å–å‰ªè´´æ¿å†…å®¹å¤±è´¥ï¼Œæ‰“å°é”™è¯¯æ¶ˆæ¯
							console.error('Error reading clipboard:', err);
							alert('æ— æ³•ä»å‰ªè´´æ¿å¤åˆ¶å†…å®¹ã€‚');
						});

				}

			);
		</script>

	</body>
</html>